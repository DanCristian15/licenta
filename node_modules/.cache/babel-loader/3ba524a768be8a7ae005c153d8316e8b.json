{"remainingRequest":"/Users/cristiandan/Desktop/lifestyle-ui/node_modules/babel-loader/lib/index.js!/Users/cristiandan/Desktop/lifestyle-ui/src/tenants/ticketmaster/app/filters/cancellationPolicyCharge.js","dependencies":[{"path":"/Users/cristiandan/Desktop/lifestyle-ui/src/tenants/ticketmaster/app/filters/cancellationPolicyCharge.js","mtime":1645805365927},{"path":"/Users/cristiandan/Desktop/lifestyle-ui/node_modules/cache-loader/dist/cjs.js","mtime":1637061222564},{"path":"/Users/cristiandan/Desktop/lifestyle-ui/node_modules/babel-loader/lib/index.js","mtime":1637061222406}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGkxOG5leHQgZnJvbSAnaTE4bmV4dCc7CmltcG9ydCBkYXRlQ29uc3RhbnRzIGZyb20gJ0Bjb3JlL3V0aWxzL2NvbnN0YW50cy9kYXRlJzsKaW1wb3J0IGRhdGVGaWx0ZXIgZnJvbSAnQGNvcmUvZmlsdGVycy9kYXRlJzsKaW1wb3J0IGN1cnJlbmN5RnVsbEZpbHRlciBmcm9tICdAL2NvcmUvZmlsdGVycy9jdXJyZW5jeUZ1bGwnOwppbXBvcnQgY2FuY2VsbGF0aW9uUG9saWN5IGZyb20gJy4vY2FuY2VsbGF0aW9uUG9saWN5JzsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKF9yZWYsIGN1cnJlbmN5LCBiYXNlUHJpY2UsIGFjY29tb2RhdGlvbk5pZ2h0cykgewogIHZhciBjdXJyZW50ID0gX3JlZi5jdXJyZW50LAogICAgICBmdXR1cmVzID0gX3JlZi5mdXR1cmVzOwogIHZhciBjdXJyZW50UG9saWN5ID0gY3VycmVudCB8fCBmdXR1cmVzWzBdOwogIHZhciB0ZXh0ID0gIiIuY29uY2F0KGNhbmNlbGxhdGlvblBvbGljeShjdXJyZW50UG9saWN5LCBjdXJyZW5jeSksICIuIik7CgogIGlmIChjdXJyZW50UG9saWN5ICYmICFmdXR1cmVzKSB7CiAgICB2YXIgdGltZSA9IGRhdGVGaWx0ZXIoY3VycmVudFBvbGljeS5mcm9tQXQsIGRhdGVDb25zdGFudHMuRk9STUFULlRJTUUpOwogICAgdmFyIGRhdGUgPSBkYXRlRmlsdGVyKGN1cnJlbnRQb2xpY3kuZnJvbUF0LCBkYXRlQ29uc3RhbnRzLkZPUk1BVC5VSV9EQVRFKTsKICAgIHZhciBhbW91bnQgPSBjb21wdXRlQW1vdW50KGN1cnJlbnRQb2xpY3ksIGJhc2VQcmljZSwgYWNjb21vZGF0aW9uTmlnaHRzLCBjdXJyZW5jeSk7CiAgICB0ZXh0ICs9ICIgIi5jb25jYXQoaTE4bmV4dC50KCdfY29tbW9uOnRlcm1zLmZyZWVDYW5jZWxsYXRpb25DaGFyZ2UnLCB7CiAgICAgIGFtb3VudDogYW1vdW50LAogICAgICBkYXRlOiBkYXRlLAogICAgICB0aW1lOiB0aW1lCiAgICB9KSwgIi4iKTsKICB9CgogIGlmIChmdXR1cmVzKSB7CiAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgZnV0dXJlcy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgdmFyIGVsZW1lbnQgPSBmdXR1cmVzW2luZGV4XTsKCiAgICAgIHZhciBfdGltZSA9IGRhdGVGaWx0ZXIoZWxlbWVudC5mcm9tQXQsIGRhdGVDb25zdGFudHMuRk9STUFULlRJTUUpOwoKICAgICAgdmFyIF9kYXRlID0gZGF0ZUZpbHRlcihlbGVtZW50LmZyb21BdCwgZGF0ZUNvbnN0YW50cy5GT1JNQVQuVUlfREFURSk7CgogICAgICB2YXIgX2Ftb3VudCA9IGNvbXB1dGVBbW91bnQoZWxlbWVudCwgYmFzZVByaWNlLCBhY2NvbW9kYXRpb25OaWdodHMsIGN1cnJlbmN5KTsKCiAgICAgIHRleHQgKz0gIiAiLmNvbmNhdChpMThuZXh0LnQoJ19jb21tb246dGVybXMuZnJlZUNhbmNlbGxhdGlvbkNoYXJnZScsIHsKICAgICAgICBhbW91bnQ6IF9hbW91bnQsCiAgICAgICAgZGF0ZTogX2RhdGUsCiAgICAgICAgdGltZTogX3RpbWUKICAgICAgfSksICIuIik7CiAgICB9CiAgfQoKICByZXR1cm4gdGV4dDsKfQoKZnVuY3Rpb24gY29tcHV0ZUFtb3VudChwb2xpY3ksIGJhc2VQcmljZSwgYWNjb21vZGF0aW9uTmlnaHRzLCBjdXJyZW5jeSkgewogIHZhciBhbW91bnQgPSAwOwoKICBpZiAocG9saWN5LmFtb3VudCkgewogICAgYW1vdW50ID0gY3VycmVuY3lGdWxsRmlsdGVyKHBvbGljeS5hbW91bnQsIGN1cnJlbmN5KTsKICB9CgogIGlmIChwb2xpY3kucGVyY2VudCkgewogICAgYW1vdW50ID0gY3VycmVuY3lGdWxsRmlsdGVyKGJhc2VQcmljZSAqIChwb2xpY3kucGVyY2VudCAvIDEwMCksIGN1cnJlbmN5KTsKICB9CgogIGlmIChwb2xpY3kubnVtYmVyT2ZOaWdodHMpIHsKICAgIGFtb3VudCA9IGN1cnJlbmN5RnVsbEZpbHRlcihiYXNlUHJpY2UgLyBhY2NvbW9kYXRpb25OaWdodHMgKiBwb2xpY3kubnVtYmVyT2ZOaWdodHMsIGN1cnJlbmN5KTsKICB9CgogIHJldHVybiBhbW91bnQ7Cn0="},{"version":3,"sources":["/Users/cristiandan/Desktop/lifestyle-ui/src/tenants/ticketmaster/app/filters/cancellationPolicyCharge.js"],"names":["i18next","dateConstants","dateFilter","currencyFullFilter","cancellationPolicy","currency","basePrice","accomodationNights","current","futures","currentPolicy","text","time","fromAt","FORMAT","TIME","date","UI_DATE","amount","computeAmount","t","index","length","element","policy","percent","numberOfNights"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,aAAP,MAA0B,4BAA1B;AACA,OAAOC,UAAP,MAAuB,oBAAvB;AACA,OAAOC,kBAAP,MAA+B,6BAA/B;AACA,OAAOC,kBAAP,MAA+B,sBAA/B;AAEA,eAAe,gBAAiCC,QAAjC,EAA2CC,SAA3C,EAAsDC,kBAAtD,EAA2E;AAAA,MAA9DC,OAA8D,QAA9DA,OAA8D;AAAA,MAArDC,OAAqD,QAArDA,OAAqD;AACtF,MAAMC,aAAa,GAAGF,OAAO,IAAIC,OAAO,CAAC,CAAD,CAAxC;AACA,MAAIE,IAAI,aAAMP,kBAAkB,CAAEM,aAAF,EAAiBL,QAAjB,CAAxB,MAAR;;AAEA,MAAKK,aAAa,IAAI,CAACD,OAAvB,EAAiC;AAC7B,QAAMG,IAAI,GAAIV,UAAU,CAAEQ,aAAa,CAACG,MAAhB,EAAwBZ,aAAa,CAACa,MAAd,CAAqBC,IAA7C,CAAxB;AACA,QAAMC,IAAI,GAAId,UAAU,CAAEQ,aAAa,CAACG,MAAhB,EAAwBZ,aAAa,CAACa,MAAd,CAAqBG,OAA7C,CAAxB;AACA,QAAMC,MAAM,GAAGC,aAAa,CAAET,aAAF,EAAiBJ,SAAjB,EAA4BC,kBAA5B,EAAgDF,QAAhD,CAA5B;AAEAM,IAAAA,IAAI,eAAQX,OAAO,CAACoB,CAAR,CAAW,sCAAX,EAAmD;AAAEF,MAAAA,MAAM,EAANA,MAAF;AAAUF,MAAAA,IAAI,EAAJA,IAAV;AAAgBJ,MAAAA,IAAI,EAAJA;AAAhB,KAAnD,CAAR,MAAJ;AACH;;AAED,MAAKH,OAAL,EAAe;AACX,SAAM,IAAIY,KAAK,GAAG,CAAlB,EAAqBA,KAAK,GAAGZ,OAAO,CAACa,MAArC,EAA6CD,KAAK,EAAlD,EAAuD;AACnD,UAAME,OAAO,GAAGd,OAAO,CAACY,KAAD,CAAvB;;AACA,UAAMT,KAAI,GAAIV,UAAU,CAAEqB,OAAO,CAACV,MAAV,EAAkBZ,aAAa,CAACa,MAAd,CAAqBC,IAAvC,CAAxB;;AACA,UAAMC,KAAI,GAAId,UAAU,CAAEqB,OAAO,CAACV,MAAV,EAAkBZ,aAAa,CAACa,MAAd,CAAqBG,OAAvC,CAAxB;;AACA,UAAMC,OAAM,GAAGC,aAAa,CAAEI,OAAF,EAAWjB,SAAX,EAAsBC,kBAAtB,EAA0CF,QAA1C,CAA5B;;AAEAM,MAAAA,IAAI,eAAQX,OAAO,CAACoB,CAAR,CAAW,sCAAX,EAAmD;AAAEF,QAAAA,MAAM,EAANA,OAAF;AAAUF,QAAAA,IAAI,EAAJA,KAAV;AAAgBJ,QAAAA,IAAI,EAAJA;AAAhB,OAAnD,CAAR,MAAJ;AACH;AACJ;;AAED,SAAOD,IAAP;AACH;;AAED,SAASQ,aAAT,CAAwBK,MAAxB,EAAgClB,SAAhC,EAA2CC,kBAA3C,EAA+DF,QAA/D,EAA0E;AACtE,MAAIa,MAAM,GAAG,CAAb;;AAEA,MAAKM,MAAM,CAACN,MAAZ,EAAqB;AACjBA,IAAAA,MAAM,GAAGf,kBAAkB,CAAEqB,MAAM,CAACN,MAAT,EAAiBb,QAAjB,CAA3B;AACH;;AAED,MAAKmB,MAAM,CAACC,OAAZ,EAAsB;AAClBP,IAAAA,MAAM,GAAGf,kBAAkB,CAAEG,SAAS,IAAKkB,MAAM,CAACC,OAAP,GAAiB,GAAtB,CAAX,EAAwCpB,QAAxC,CAA3B;AACH;;AAED,MAAKmB,MAAM,CAACE,cAAZ,EAA6B;AACzBR,IAAAA,MAAM,GAAGf,kBAAkB,CAAIG,SAAS,GAAGC,kBAAd,GAAqCiB,MAAM,CAACE,cAA9C,EAA8DrB,QAA9D,CAA3B;AACH;;AAED,SAAOa,MAAP;AACH","sourcesContent":["import i18next from 'i18next';\nimport dateConstants from '@core/utils/constants/date';\nimport dateFilter from '@core/filters/date';\nimport currencyFullFilter from '@/core/filters/currencyFull';\nimport cancellationPolicy from './cancellationPolicy';\n\nexport default function ( { current, futures }, currency, basePrice, accomodationNights ) {\n    const currentPolicy = current || futures[0];\n    let text = `${cancellationPolicy( currentPolicy, currency )}.`;\n\n    if ( currentPolicy && !futures ) {\n        const time =  dateFilter( currentPolicy.fromAt, dateConstants.FORMAT.TIME );\n        const date =  dateFilter( currentPolicy.fromAt, dateConstants.FORMAT.UI_DATE );\n        const amount = computeAmount( currentPolicy, basePrice, accomodationNights, currency );\n\n        text += ` ${i18next.t( '_common:terms.freeCancellationCharge', { amount, date, time } )}.`;\n    }\n\n    if ( futures ) {\n        for ( let index = 0; index < futures.length; index++ ) {\n            const element = futures[index];\n            const time =  dateFilter( element.fromAt, dateConstants.FORMAT.TIME );\n            const date =  dateFilter( element.fromAt, dateConstants.FORMAT.UI_DATE );\n            const amount = computeAmount( element, basePrice, accomodationNights, currency );\n\n            text += ` ${i18next.t( '_common:terms.freeCancellationCharge', { amount, date, time } )}.`;\n        }\n    }\n\n    return text;\n}\n\nfunction computeAmount( policy, basePrice, accomodationNights, currency ) {\n    let amount = 0;\n\n    if ( policy.amount ) {\n        amount = currencyFullFilter( policy.amount, currency );\n    }\n\n    if ( policy.percent ) {\n        amount = currencyFullFilter( basePrice * ( policy.percent / 100 ), currency );\n    }\n\n    if ( policy.numberOfNights ) {\n        amount = currencyFullFilter( ( basePrice / accomodationNights ) * policy.numberOfNights, currency );\n    }\n\n    return amount;\n}"]}]}